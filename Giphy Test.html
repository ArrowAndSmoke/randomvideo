<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Giphy Test</title>
    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
</head>

<body>
    <img src="PoweredBy_640_Horizontal_Light-Backgrounds_With_Logo.gif" />
    <span id="giphyme"></span>
    <span id="searchWord"></span>
    <script>
    var lyrics = ["Hello, it's me",
        "I was wondering if after all these years",
        "You'd like to meet, to go over everything",
        "They say that time's supposed to heal ya",
        "But I ain't done much healing"
    ];

    var lyricsHandler = {
        currentWord: "adele",
        line: 0,
       reset: function(){
           this.currentWord = "adele";
           this.line = 0;
            //used when a new song is playing to reset  the object back to stock
        }
    };

    var lyricsSetter = function(obj) {

        var currentLine = lyrics[obj.line].split(' '); //["hello,", "it's", "me"]
        console.log(currentLine);
        obj.currentWord = currentLine[Math.floor(Math.random() * currentLine.length)]; //randomly select a word from currentLine
        console.log(obj.currentWord)
        if (obj.line === lyrics.length - 2) { // if the last line is accessed, restart 
            obj.line = 0;
        }
        obj.line++;
        console.log(lyricsHandler);
    };


    var picLoader = function() {
        document.getElementById("searchWord").innerHTML = lyricsHandler.currentWord;
        request = new XMLHttpRequest;

        request.open('GET', 'http://api.giphy.com/v1/gifs/random?api_key=dc6zaTOxFJmzC&tag=' + lyricsHandler.currentWord, true);
        //console.log(lyricsHandler.currentWord);
        request.onload = function() {
            // console.log('test');
            if (request.status >= 200 && request.status < 400) {

                data = JSON.parse(request.responseText).data.image_url;
                if (data != undefined) {
                    console.log(data);
                    document.getElementById("giphyme").innerHTML = '<center><img src = "' + data + '"  title="GIF via Giphy"></center>';
                }

            } else {
                console.log('reached giphy, but API returned an error');
            }
        };

        request.onerror = function() {
            console.log('connection error');
        };

        request.send();

    };
    window.setInterval(function() {
        lyricsSetter(lyricsHandler);
    }, 5001); //+1 so the very first query will always be of the artist
    window.setInterval(picLoader, 5000);
    </script>
    <!--    <div id="picture"></div>
    <form id="searchForm">
        Artist:
        <input id="artist" type="text" />
        Title:
        <input id="title" type="text" />
    </form>
    <button id="btn">search</button>
    <p id="output"></p>
    
  <script>
    var searchField = $(document.getElementById("pic"));
    var submit = document.getElementById("btn");
    console.log(searchField);

    $(submit).on("click", function() {
        get_pictures(searchField.val())
    })

    $(submit).on("click", function() {
        get_pictures(searchField.val())
    }) //for the keypress



    var get_pictures = function(searchField) {
        $.ajax({
            url: "https://api.imgur.com/3/gallery/search?q=" + encodeURI(searchField),
            headers: {
                "Authorization": "Client-ID e3776adbe9c5fb9"
            },
            success: function(response) {
                console.log(response)
            }
        })
    }
    </script> -->
</body>

</html>
